// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.16/esri/copyright.txt for details.
//>>built
require({cache:{"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(l,k,f,n,e,a){l=n("dijit._OnDijitClickMixin",null,{connect:function(e,c,s){return this.inherited(arguments,[e,"ondijitclick"==c?a:c,s])}});l.a11yclick=a;return l})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),function(l,k,f,n,e,a,m){var c={_isElementShown:function(a){var b=
n.get(a);return"hidden"!=b.visibility&&"collapsed"!=b.visibility&&"none"!=b.display&&"hidden"!=f.get(a,"type")},hasDefaultTabStop:function(a){switch(a.nodeName.toLowerCase()){case "a":return f.has(a,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;case "iframe":var b;try{var c=a.contentDocument;if("designMode"in c&&"on"==c.designMode)return!0;b=c.body}catch(e){try{b=a.contentWindow.document.body}catch(k){return!1}}return b&&("true"==b.contentEditable||
b.firstChild&&"true"==b.firstChild.contentEditable);default:return"true"==a.contentEditable}},effectiveTabIndex:function(a){return f.get(a,"disabled")?void 0:f.has(a,"tabIndex")?+f.get(a,"tabIndex"):c.hasDefaultTabStop(a)?0:void 0},isTabNavigable:function(a){return 0<=c.effectiveTabIndex(a)},isFocusable:function(a){return-1<=c.effectiveTabIndex(a)},_getTabNavigable:function(e){function b(a){return a&&"input"==a.tagName.toLowerCase()&&a.type&&"radio"==a.type.toLowerCase()&&a.name&&a.name.toLowerCase()}
var t,k,m,n,l,x,y={},F=c._isElementShown,u=c.effectiveTabIndex,A=function(c){for(c=c.firstChild;c;c=c.nextSibling)if(!(1!=c.nodeType||9>=a("ie")&&"HTML"!==c.scopeName||!F(c))){var p=u(c);if(0<=p){if(0==p)t||(t=c),k=c;else if(0<p){if(!m||p<n)n=p,m=c;if(!l||p>=x)x=p,l=c}p=b(c);f.get(c,"checked")&&p&&(y[p]=c)}"SELECT"!=c.nodeName.toUpperCase()&&A(c)}};F(e)&&A(e);return{first:y[b(t)]||t,last:y[b(k)]||k,lowest:y[b(m)]||m,highest:y[b(l)]||l}},getFirstInTabbingOrder:function(a,b){var e=c._getTabNavigable(k.byId(a,
b));return e.lowest?e.lowest:e.first},getLastInTabbingOrder:function(a,b){var e=c._getTabNavigable(k.byId(a,b));return e.last?e.last:e.highest}};e.mixin(m,c);return c})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(l,k,f,n){function e(a){if((a.keyCode===l.ENTER||a.keyCode===l.SPACE)&&!/input|button|textarea/i.test(a.target.nodeName))for(a=a.target;a;a=a.parentNode)if(a.dojoClick)return!0}var a;f(document,"keydown",function(c){e(c)?(a=c.target,c.preventDefault()):
a=null});f(document,"keyup",function(c){e(c)&&c.target==a&&(a=null,f.emit(c.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:c.ctrlKey,shiftKey:c.shiftKey,metaKey:c.metaKey,altKey:c.altKey,_origType:c.type}))});var m=function(a,e){a.dojoClick=!0;return f(a,"click",e)};m.click=m;m.press=function(a,e){var b=f(a,n.press,function(a){("mousedown"!=a.type||k.isLeft(a))&&e(a)}),m=f(a,"keydown",function(a){(a.keyCode===l.ENTER||a.keyCode===l.SPACE)&&e(a)});return{remove:function(){b.remove();m.remove()}}};
m.release=function(a,e){var b=f(a,n.release,function(a){("mouseup"!=a.type||k.isLeft(a))&&e(a)}),m=f(a,"keyup",function(a){(a.keyCode===l.ENTER||a.keyCode===l.SPACE)&&e(a)});return{remove:function(){b.remove();m.remove()}}};m.move=n.move;return m})},"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),function(l,k,f,n,e,a){l=l([a],{declaredClass:"esri.layers.KMLGroundOverlay",constructor:function(a){e.isDefined(this.visibility)&&
(this.visible=!!this.visibility)}});f("extend-esri")&&k.setObject("layers.KMLGroundOverlay",l,n);return l})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),function(l,k,f,n,e,a,m,c,s,b){function t(d,h,q){return z&&q?function(d,h){return a(d,q,h)}:y?function(q,r){var p=a(q,h,function(d){r.call(this,d);g=(new Date).getTime()}),y=a(q,d,function(d){(!g||(new Date).getTime()>g+1E3)&&r.call(this,d)});return{remove:function(){p.remove();
y.remove()}}}:function(h,g){return a(h,d,g)}}function w(d){do if(void 0!==d.dojoClick)return d;while(d=d.parentNode)}function E(g,q,y){var c=w(g.target);if(u=!g.target.disabled&&c&&c.dojoClick)if(B=(A="useTarget"==u)?c:g.target,A&&g.preventDefault(),p=g.changedTouches?g.changedTouches[0].pageX-b.global.pageXOffset:g.clientX,C=g.changedTouches?g.changedTouches[0].pageY-b.global.pageYOffset:g.clientY,d=("object"==typeof u?u.x:"number"==typeof u?u:0)||4,r=("object"==typeof u?u.y:"number"==typeof u?u:
0)||4,!F){F=!0;var e=function(h){u=A?f.isDescendant(b.doc.elementFromPoint(h.changedTouches?h.changedTouches[0].pageX-b.global.pageXOffset:h.clientX,h.changedTouches?h.changedTouches[0].pageY-b.global.pageYOffset:h.clientY),B):u&&(h.changedTouches?h.changedTouches[0].target:h.target)==B&&Math.abs((h.changedTouches?h.changedTouches[0].pageX-b.global.pageXOffset:h.clientX)-p)<=d&&Math.abs((h.changedTouches?h.changedTouches[0].pageY-b.global.pageYOffset:h.clientY)-C)<=r};b.doc.addEventListener(q,function(d){e(d);
A&&d.preventDefault()},!0);b.doc.addEventListener(y,function(d){e(d);if(u){h=(new Date).getTime();var g=A?B:d.target;"LABEL"===g.tagName&&(g=f.byId(g.getAttribute("for"))||g);var q=d.changedTouches?d.changedTouches[0]:d,r=document.createEvent("MouseEvents");r._dojo_click=!0;r.initMouseEvent("click",!0,!0,d.view,d.detail,q.screenX,q.screenY,q.clientX,q.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,null);setTimeout(function(){a.emit(g,"click",r);h=(new Date).getTime()},0)}},!0);g=function(d){b.doc.addEventListener(d,
function(g){!g._dojo_click&&((new Date).getTime()<=h+1E3&&!("INPUT"==g.target.tagName&&n.contains(g.target,"dijitOffScreen")))&&(g.stopPropagation(),g.stopImmediatePropagation&&g.stopImmediatePropagation(),"click"==d&&(("INPUT"!=g.target.tagName||"radio"==g.target.type||"checkbox"==g.target.type)&&"TEXTAREA"!=g.target.tagName&&"AUDIO"!=g.target.tagName&&"VIDEO"!=g.target.tagName)&&g.preventDefault())},!0)};g("click");g("mousedown");g("mouseup")}}var v=5>m("ios"),z=m("pointer-events")||m("MSPointer"),
x=function(){var d={},h;for(h in{down:1,move:1,up:1,cancel:1,over:1,out:1})d[h]=m("MSPointer")?"MSPointer"+h.charAt(0).toUpperCase()+h.slice(1):"pointer"+h;return d}(),y=m("touch-events"),F,u,A=!1,B,p,C,d,r,h,g,q;z?s(function(){b.doc.addEventListener(x.down,function(d){E(d,x.move,x.up)},!0)}):y&&s(function(){function d(h){var g=e.delegate(h,{bubbles:!0});6<=m("ios")&&(g.touches=h.touches,g.altKey=h.altKey,g.changedTouches=h.changedTouches,g.ctrlKey=h.ctrlKey,g.metaKey=h.metaKey,g.shiftKey=h.shiftKey,
g.targetTouches=h.targetTouches);return g}q=b.body();b.doc.addEventListener("touchstart",function(d){g=(new Date).getTime();var h=q;q=d.target;a.emit(h,"dojotouchout",{relatedTarget:q,bubbles:!0});a.emit(q,"dojotouchover",{relatedTarget:h,bubbles:!0});E(d,"touchmove","touchend")},!0);a(b.doc,"touchmove",function(h){g=(new Date).getTime();var r=b.doc.elementFromPoint(h.pageX-(v?0:b.global.pageXOffset),h.pageY-(v?0:b.global.pageYOffset));r&&(q!==r&&(a.emit(q,"dojotouchout",{relatedTarget:r,bubbles:!0}),
a.emit(r,"dojotouchover",{relatedTarget:q,bubbles:!0}),q=r),a.emit(r,"dojotouchmove",d(h))||h.preventDefault())});a(b.doc,"touchend",function(h){g=(new Date).getTime();var q=b.doc.elementFromPoint(h.pageX-(v?0:b.global.pageXOffset),h.pageY-(v?0:b.global.pageYOffset))||b.body();a.emit(q,"dojotouchend",d(h))})});k={press:t("mousedown","touchstart",x.down),move:t("mousemove","dojotouchmove",x.move),release:t("mouseup","dojotouchend",x.up),cancel:t(c.leave,"touchcancel",z?x.cancel:null),over:t("mouseover",
"dojotouchover",x.over),out:t("mouseout","dojotouchout",x.out),enter:c._eventHandler(t("mouseover","dojotouchover",x.over)),leave:c._eventHandler(t("mouseout","dojotouchout",x.out))};return l.touch=k})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(l,k,f,n,e,a,m,c,s){var b=e.delegate(c,{mouseenter:a.enter,mouseleave:a.leave,keypress:f._keypress}),t;f=n("dijit._AttachMixin",
null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var b=a;;)if(1==b.nodeType&&(this._processTemplateNode(b,function(a,b){return a.getAttribute(b)},this._attach)||this.searchContainerNode)&&b.firstChild)b=b.firstChild;else{if(b==a)break;for(;!b.nextSibling;)if(b=b.parentNode,b==a)return;b=
b.nextSibling}},_processTemplateNode:function(a,b,c){var f=!0,k=this.attachScope||this,y=b(a,"dojoAttachPoint")||b(a,"data-dojo-attach-point");if(y)for(var F=y.split(/\s*,\s*/);y=F.shift();)e.isArray(k[y])?k[y].push(a):k[y]=a,f="containerNode"!=y,this._attachPoints.push(y);if(b=b(a,"dojoAttachEvent")||b(a,"data-dojo-attach-event")){y=b.split(/\s*,\s*/);for(F=e.trim;b=y.shift();)if(b){var u=null;-1!=b.indexOf(":")?(u=b.split(":"),b=F(u[0]),u=F(u[1])):b=F(b);u||(u=b);this._attachEvents.push(c(a,b,e.hitch(k,
u)))}}return f},_attach:function(a,c,e){c=c.replace(/^on/,"").toLowerCase();c="dijitclick"==c?t||(t=l("./a11yclick")):b[c]||c;return m(a,c,e)},_detachTemplateNodes:function(){var a=this.attachScope||this;k.forEach(this._attachPoints,function(b){delete a[b]});this._attachPoints=[];k.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});e.extend(s,{dojoAttachEvent:"",dojoAttachPoint:""});return f})},
"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all ./lang ./kernel ./request ./tasks/query ./tasks/QueryTask ./tasks/StatisticDefinition dojo/i18n!dojo/cldr/nls/number".split(" "),function(l,k,f,n,e,a,m,c,s,b,t,w,E,v,z,x){l=l(null,{declaredClass:"esri.PopupInfo",initialize:function(a,b){if(a){k.mixin(this,b);this.info=a;this.title=this.getTitle;this.content=this.getContent;var c=this._fieldLabels=
{},e=this._fieldsMap={};a.fieldInfos&&f.forEach(a.fieldInfos,function(a){var b=a.fieldName.toLowerCase();c[b]=a.label;e[b]=a});this._relatedFieldPrefix="relationships/";this.titleHasRelatedFields=!!(a.title&&-1!==a.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return n.fromJson(n.toJson(this.info))},getTitle:function(){},getContent:function(){},getFieldInfo:function(a){var b;f.some(this.info&&this.info.fieldInfos,function(c){c.fieldName===a&&(b=c);return!!b});return b},getComponents:function(a){var b=
this.info,c=new m,e,s;b.fieldInfos&&(s=f.filter(b.fieldInfos,function(a){return-1!==a.fieldName.indexOf(this._relatedFieldPrefix)},this));s&&0<s.length&&(e=this._getRelatedRecords({graphic:a,fieldsInfo:s}));e?e.always(k.hitch(this,function(){c.resolve(this._getPopupValues(a))})):c.resolve(this._getPopupValues(a));return c.promise},getAttachments:function(a){var b=a.getLayer();a=a.attributes;if(this.info.showAttachments&&(b&&b.hasAttachments&&b.objectIdField)&&(a=a&&a[b.objectIdField]))return b.queryAttachmentInfos(a)},
_getPopupValues:function(a,c){var e=this.info,s=a.getLayer(),m=k.clone(a.attributes)||{},p=k.clone(m),C=e.fieldInfos,d="",r="",h,g,q,K,I,n=s&&s._getDateOpts&&s._getDateOpts().properties,n=n&&n.slice(0),t={dateFormat:{properties:n,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};if(this._relatedInfo)for(K in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(K)){var l=this._relatedInfo[K],D=this._relatedLayersInfo[K];l&&(f.forEach(l.relatedFeatures,function(d){for(I in d.attributes)if(d.attributes.hasOwnProperty(I)&&
"esriRelCardinalityOneToOne"===D.relation.cardinality){var h=this._toRelatedFieldName([D.relation.id,I]);m[h]=p[h]=d.attributes[I]}},this),f.forEach(l.relatedStatsFeatures,function(d){for(I in d.attributes)if(d.attributes.hasOwnProperty(I)){var h=this._toRelatedFieldName([D.relation.id,I]);m[h]=p[h]=d.attributes[I]}},this))}C&&f.forEach(C,function(d){g=d.fieldName;var h=this._getLayerFieldInfo(s,g);h&&(g=d.fieldName=h.name);p[g]=this._formatValue(p[g],g,t);n&&(d.format&&d.format.dateFormat)&&(d=f.indexOf(n,
g),-1<d&&n.splice(d,1))},this);if(s){K=s.types;var x=(l=s.typeIdField)&&m[l];for(g in m)if(m.hasOwnProperty(g)&&-1===g.indexOf(this._relatedFieldPrefix)&&(q=m[g],b.isDefined(q))){var v=this._getDomainName(s,a,K,x,g,q);b.isDefined(v)?p[g]=v:g===l&&(v=this._getTypeName(s,a,q),b.isDefined(v)&&(p[g]=v))}}e.title&&(d=this._processFieldsInLinks(this._fixTokens(e.title,s),m),d=k.trim(b.substitute(p,d,t)||""));if(c)return{title:d};e.description&&(r=this._processFieldsInLinks(this._fixTokens(e.description,
s),m),r=k.trim(b.substitute(p,r,t)||""));C&&(h=[],f.forEach(C,function(d){(g=d.fieldName)&&d.visible&&h.push([d.label||g,b.substitute(p,"${"+g+"}",t)||""])}));var w,E;e.mediaInfos&&(w=[],f.forEach(e.mediaInfos,function(d){E=0;q=d.value;switch(d.type){case "image":var h=q.sourceURL,h=h&&k.trim(b.substitute(m,this._fixTokens(h,s)));E=!!h;break;case "piechart":case "linechart":case "columnchart":case "barchart":var g,h=q.normalizeField;q.fields=f.map(q.fields,function(d){return(g=this._getLayerFieldInfo(s,
d))?g.name:d},this);h&&(g=this._getLayerFieldInfo(s,h),q.normalizeField=g?g.name:h);E=f.some(q.fields,function(d){return b.isDefined(m[d])||-1!==d.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(E){d=k.clone(d);q=d.value;var h=d.title?this._processFieldsInLinks(this._fixTokens(d.title,s),m):"",a=d.caption?this._processFieldsInLinks(this._fixTokens(d.caption,s),m):"";d.title=h?k.trim(b.substitute(p,h,t)||""):"";d.caption=a?k.trim(b.substitute(p,a,t)||""):"";if("image"===
d.type)q.sourceURL=b.substitute(m,this._fixTokens(q.sourceURL,s)),q.linkURL&&(q.linkURL=k.trim(b.substitute(m,this._fixTokens(q.linkURL,s))||""));else{var r,c;f.forEach(q.fields,function(d,h){if(-1!==d.indexOf(this._relatedFieldPrefix))c=this._getRelatedChartInfos(d,q,m,t),c instanceof Array?q.fields=c:q.fields[h]=c;else{var g=m[d],g=void 0===g?null:g;r=m[q.normalizeField]||0;g&&r&&(g/=r);q.fields[h]={y:g,tooltip:(this._fieldLabels[d.toLowerCase()]||d)+":\x3cbr/\x3e"+this._formatValue(g,d,t,!!r)}}},
this)}w.push(d)}},this));return{title:d,description:r,hasDescription:!!e.description,fields:h&&h.length?h:null,mediaInfos:w&&w.length?w:null,formatted:p,editSummary:s&&s.getEditSummary?s.getEditSummary(a):""}},_getRelatedChartInfos:function(a,b,c,e){var s,p,C,d,r,h;s=[];h=this._fromRelatedFieldName(a);r=h[0];p=this._relatedInfo[r];r=this._relatedLayersInfo[r];p&&f.forEach(p.relatedFeatures,function(g){g=g.attributes;var q,r;for(r in g)if(g.hasOwnProperty(r)&&r===h[1]){q={};d=g[r];b.normalizeField&&
(C=-1!==b.normalizeField.indexOf(this._relatedFieldPrefix)?g[this._fromRelatedFieldName(b.normalizeField)[1]]:c[b.normalizeField]);d&&C&&(d/=C);if(b.tooltipField)if(-1!==b.tooltipField.indexOf(this._relatedFieldPrefix)){var p=this._fromRelatedFieldName(b.tooltipField)[1];q.tooltip=g[p]&&"string"===typeof g[p]?g[p]+":\x3cbr/\x3e"+this._formatValue(d,g[p],e,!!C):p+":\x3cbr/\x3e"+this._formatValue(d,p,e,!!C)}else q.tooltip=(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(d,b.tooltipField,
e,!!C);else q.tooltip=d;q.y=d;s.push(q)}},this);return"esriRelCardinalityOneToMany"===r.relation.cardinality||"esriRelCardinalityManyToMany"===r.relation.cardinality?s:s[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",
shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",
shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,_fixTokens:function(a,b){var c=this;return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,e,p){a=c._getLayerFieldInfo(b,p);return"$"+(a?"{"+a.name+"}":e)})},_encodeAttributes:function(a){a=
k.clone(a)||{};var b,c;for(b in a)if((c=a[b])&&"string"===typeof c)c=encodeURIComponent(c).replace(/\'/g,"\x26apos;"),a[b]=c;return a},_processFieldsInLinks:function(a,b){var c=this._encodeAttributes(b),e=this;a&&(a=a.replace(this._reHref,function(a,p){return e._addValuesToHref(a,p,b,c)}).replace(this._reHrefApos,function(a,p){return e._addValuesToHref(a,p,b,c)}));return a},_addValuesToHref:function(a,c,e,s){c=c&&k.trim(c);return b.substitute(c&&0===c.indexOf("${")?e:s,a)},_getLayerFieldInfo:function(a,
b){return a&&a.getField?a.getField(b):null},_formatValue:function(a,c,e,s){var m=this._fieldsMap[c.toLowerCase()],p=m&&m.format;c=-1!==f.indexOf(e.dateFormat.properties,c);var C="number"===typeof a&&!c&&(!p||!p.dateFormat);if(!b.isDefined(a)||!m||!b.isDefined(p))return C?this._forceLTR(a):a;var d="",m=[],r=p.hasOwnProperty("places")||p.hasOwnProperty("digitSeparator"),h=p.hasOwnProperty("digitSeparator")?p.digitSeparator:!0;if(r&&!c)d="NumberFormat",m.push("places: "+(b.isDefined(p.places)&&(!s||
0<p.places)?Number(p.places):"Infinity")),m.length&&(d+="("+m.join(",")+")");else if(p.dateFormat)d="DateFormat"+this._insertOffset(this._dateFormats[p.dateFormat]||this._dateFormats.shortDateShortTime);else return C?this._forceLTR(a):a;var g=this._applyFormatting(a,d,e);r&&-1<a.constructor.toString().indexOf("Array")&&(g="",f.forEach(a,k.hitch(this,function(h){g=g+this._applyFormatting(h,d,e)+" "})));r&&!h&&x.group&&(g=g.replace(RegExp("\\"+x.group,"g"),""));return C?this._forceLTR(g):g},_applyFormatting:function(a,
c,e){return b.substitute({myKey:a},"${myKey:"+c+"}",e)||""},_forceLTR:function(a){var b=c("ie");return b&&10>=b?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+a+"\x3c/span\x3e"},_insertOffset:function(a){a&&(a=b.isDefined(this.utcOffset)?a.replace(/\)\s*$/,", utcOffset:"+this.utcOffset+")"):a);return a},_getDomainName:function(a,b,c,e,s,p){return(a=a.getDomain&&a.getDomain(s,{feature:b}))&&a.codedValues?a.getName(p):null},_getTypeName:function(a,b,c){return(a=a.getType&&a.getType(b))&&a.name},_getRelatedRecords:function(a){var b=
a.graphic,c=new m,e;this._relatedLayersInfo?this._queryRelatedLayers(b).then(k.hitch(this,function(a){this._setRelatedRecords(b,a);c.resolve(a)}),k.hitch(this,this._handlerErrorResponse,c)):this._getRelatedLayersInfo(a).then(k.hitch(this,function(a){for(e in a)a.hasOwnProperty(e)&&a[e]&&(this._relatedLayersInfo[e].relatedLayerInfo=a[e]);this._queryRelatedLayers(b).then(k.hitch(this,function(a){this._setRelatedRecords(b,a);c.resolve(a)}),k.hitch(this,this._handlerErrorResponse,c))}),k.hitch(this,this._handlerErrorResponse,
c));return c.promise},_getRelatedLayersInfo:function(a){var b=a.fieldsInfo,c,e,m={};c=a.graphic.getLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});f.forEach(b,function(a){var b,d,r,h;b=this._fromRelatedFieldName(a.fieldName);d=b[0];b=b[1];d&&(this._relatedLayersInfo[d]||(f.some(c.relationships,function(a){if(a.id==d)return h=a,!0}),h&&(this._relatedLayersInfo[d]={relation:h,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[d]&&(this._relatedLayersInfo[d].relatedFields.push(b),
a.statisticType&&(r=new z,r.statisticType=a.statisticType,r.onStatisticField=b,r.outStatisticFieldName=b,this._relatedLayersInfo[d].outStatistics.push(r))))},this);for(e in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(e)&&this._relatedLayersInfo[e]&&(a=this._relatedLayersInfo[e].relation,a=c.url.replace(/[0-9]+$/,a.relatedTableId),this._relatedLayersInfo[e].relatedLayerUrl=a,m[e]=w({url:a,content:{f:"json"},callbackParamName:"callback"}));return s(m)},_queryRelatedLayers:function(a){var b=
{},c;for(c in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(c)&&(b[c]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[c]}));return s(b)},_queryRelatedLayer:function(a){var b,c,e,m,p,C,d,r,h,g;b=a.graphic;c=b.getLayer().url.match(/[0-9]+$/g)[0];r=a.relatedInfo;d=r.relatedLayerInfo;h=r.relatedLayerUrl;g=r.relation;f.some(d.relationships,function(d){if(d.relatedTableId===parseInt(c,10))return e=d,!0},this);e&&(a=new E,f.some(d.fields,function(d){if(d.name===e.keyField)return p=
-1!==f.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],d.type)?"number":"string",!0}),m="string"===p?e.keyField+"\x3d'"+b.attributes[g.keyField]+"'":e.keyField+"\x3d"+b.attributes[g.keyField],a.where=m,a.outFields=r.relatedFields,r.outStatistics&&(0<r.outStatistics.length&&d.supportsStatistics)&&(C=new E,C.where=a.where,C.outFields=a.outFields,C.outStatistics=r.outStatistics),b=new v(h),m=[],m.push(b.execute(a)),C&&m.push(b.execute(C)));return s(m)},
_setRelatedRecords:function(a,c){this._relatedInfo=[];for(var e in c)if(c.hasOwnProperty(e)&&c[e]){var m=c[e];this._relatedInfo[e]={};this._relatedInfo[e].relatedFeatures=m[0].features;b.isDefined(m[1])&&(this._relatedInfo[e].relatedStatsFeatures=m[1].features)}},_handlerErrorResponse:function(a,b){a.reject(b)},_fromRelatedFieldName:function(a){var b=[];-1!==a.indexOf(this._relatedFieldPrefix)&&(a=a.split("/"),b=a.slice(1));return b},_toRelatedFieldName:function(a){var b="";a&&0<a.length&&(b=this._relatedFieldPrefix+
a[0]+"/"+a[1]);return b}});a("extend-esri")&&(t.PopupInfo=t.PopupInfoTemplate=l);return l})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),function(l,k,f,n,e,a,m,c,s,b,t,w,E,v,z,x,y){var F,u,A=new (k([w,m],{curNode:null,activeStack:[],constructor:function(){var b=c.hitch(this,function(a){f.isDescendant(this.curNode,
a)&&this.set("curNode",null);f.isDescendant(this.prevNode,a)&&this.set("prevNode",null)});l.before(a,"empty",b);l.before(a,"destroy",b)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(a,b){var d=this,r=a.document&&a.document.body;if(r){var h=t("pointer-events")?"pointerdown":t("MSPointer")?"MSPointerDown":t("touch-events")?"mousedown, touchstart":"mousedown",g=s(a.document,h,function(a){if(!a||!(a.target&&null==a.target.parentNode))d._onTouchNode(b||a.target,
"mouse")}),q=s(r,"focusin",function(a){if(a.target.tagName){var h=a.target.tagName.toLowerCase();"#document"==h||"body"==h||(z.isFocusable(a.target)?d._onFocusNode(b||a.target):d._onTouchNode(b||a.target))}}),c=s(r,"focusout",function(a){d._onBlurNode(b||a.target)});return{remove:function(){g.remove();q.remove();c.remove();r=g=q=c=null}}}},_onBlurNode:function(a){a=(new Date).getTime();a<F+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(c.hitch(this,
function(){this.set("prevNode",this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<u+100||(this._clearActiveWidgetsTimer=setTimeout(c.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(a,b){u=(new Date).getTime();this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);e.contains(a,"dijitPopup")&&(a=a.firstChild);var d=
[];try{for(;a;){var r=n.get(a,"dijitPopupParent");if(r)a=x.byId(r).domNode;else if(a.tagName&&"body"==a.tagName.toLowerCase()){if(a===E.body())break;a=v.get(a.ownerDocument).frameElement}else{var h=a.getAttribute&&a.getAttribute("widgetId"),g=h&&x.byId(h);g&&!("mouse"==b&&g.get("disabled"))&&d.unshift(h);a=a.parentNode}}}catch(q){}this._setStack(d,b)},_onFocusNode:function(a){a&&9!=a.nodeType&&(F=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),
this._onTouchNode(a),a!=this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,b){var d=this.activeStack,r=d.length-1,h=a.length-1;if(a[h]!=d[r]){this.set("activeStack",a);var g;for(g=r;0<=g&&d[g]!=a[g];g--)if(r=x.byId(d[g]))r._hasBeenBlurred=!0,r.set("focused",!1),r._focusManager==this&&r._onBlur(b),this.emit("widget-blur",r,b);for(g++;g<=h;g++)if(r=x.byId(a[g]))r.set("focused",!0),r._focusManager==this&&r._onFocus(b),this.emit("widget-focus",r,b)}},focus:function(a){if(a)try{a.focus()}catch(b){}}}));
b(function(){var a=A.registerWin(v.get(document));t("ie")&&s(window,"unload",function(){a&&(a.remove(),a=null)})});y.focus=function(a){A.focus(a)};for(var B in A)/^_/.test(B)||(y.focus[B]="function"==typeof A[B]?c.hitch(A,B):A[B]);A.watch(function(a,b,d){y.focus[a]=d});return A})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),function(l,k,f,n,e,a){return l([a,e],{_onMap:function(a){var c=this.constructor._onMap,
e;if(!c||!c.FINAL)delete this.constructor._onMap,c=this.registerConnectEvents(),c.FINAL=!0;a=a.toLowerCase();c[a]?e=this[c[a].method]:(a=this._onCamelCase(a),this[a]&&(e=a));return e},on:function(a,c){var e=this._onMap(a),b=a.replace(/\-/g,""),f="on"+b in this.domNode;return e||!f?this.inherited(arguments):this.own(n(this.domNode,b,c))[0]},emit:function(a,c,e){var b,f,n,l=a.toLowerCase(),v=this.constructor._onMap||this.registerConnectEvents();f=this[this._onMap(l)];c=c||{};c.target||(c.target=this);
f&&(v&&v[l])&&(this._onObj2Arr(function(){b=Array.prototype.slice.call(arguments)},v[l].argKeys)(c),n=k.mixin({},arguments),n[2]=b,n[0]=v[l].name.replace(/^on/,""));return this.inherited(n||arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(l,k,f,n,e,a,m,c,s,b,t,w,E,v,z,x){function y(a){return eval("("+a+")")}
function F(a){var d=a._nameCaseMap,b=a.prototype;if(!d||d._extendCnt<A){var d=a._nameCaseMap={},h;for(h in b)"_"!==h.charAt(0)&&(d[h.toLowerCase()]=h);d._extendCnt=A}return d}function u(a,d){var b=a.join();if(!B[b]){for(var h=[],g=0,q=a.length;g<q;g++){var c=a[g];h[h.length]=B[c]=B[c]||f.getObject(c)||~c.indexOf("/")&&(d?d(c):l(c))}g=h.shift();B[b]=h.length?g.createSubclass?g.createSubclass(h):g.extend.apply(g,h):g}return B[b]}new Date("X");var A=0;s.after(f,"extend",function(){A++},!0);var B={},
p={_clearCache:function(){A++;B={}},_functionFromScript:function(a,d){var b="",h="",g=a.getAttribute(d+"args")||a.getAttribute("args"),q=a.getAttribute("with"),g=(g||"").split(/\s*,\s*/);q&&q.length&&n.forEach(q.split(/\s*,\s*/),function(a){b+="with("+a+"){";h+="}"});return new Function(g,b+a.innerHTML+h)},instantiate:function(a,d,b){d=d||{};b=b||{};var h=(b.scope||k._scopeName)+"Type",g="data-"+(b.scope||k._scopeName)+"-",q=g+"type",c=g+"mixins",e=[];n.forEach(a,function(a){var g=h in d?d[h]:a.getAttribute(q)||
a.getAttribute(h);if(g){var b=a.getAttribute(c),g=b?[g].concat(b.split(/\s*,\s*/)):[g];e.push({node:a,types:g})}});return this._instantiate(e,d,b)},_instantiate:function(a,d,c,h){function g(a){!d._started&&!c.noStart&&n.forEach(a,function(a){"function"===typeof a.startup&&!a._started&&a.startup()});return a}a=n.map(a,function(a){var h=a.ctor||u(a.types,c.contextRequire);if(!h)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(h,a.node,d,c,a.scripts,a.inherited)},
this);return h?b(a).then(g):g(a)},construct:function(a,d,b,h,g,q){function e(a){A&&f.setObject(A,a);for(w=0;w<H.length;w++)s[H[w].advice||"after"](a,H[w].method,f.hitch(a,H[w].func),!0);for(w=0;w<N.length;w++)N[w].call(a);for(w=0;w<M.length;w++)a.watch(M[w].prop,M[w].func);for(w=0;w<L.length;w++)z(a,L[w].event,L[w].func);return a}var m=a&&a.prototype;h=h||{};var p={};h.defaults&&f.mixin(p,h.defaults);q&&f.mixin(p,q);var l;E("dom-attributes-explicit")?l=d.attributes:E("dom-attributes-specified-flag")?
l=n.filter(d.attributes,function(a){return a.specified}):(q=(/^input$|^img$/i.test(d.nodeName)?d:d.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),l=n.map(q.split(/\s+/),function(a){var h=a.toLowerCase();return{name:a,value:"LI"==d.nodeName&&"value"==a||"enctype"==h?d.getAttribute(h):d.getAttributeNode(h).value}}));var x=h.scope||k._scopeName;q="data-"+x+"-";var D={};"dojo"!==x&&(D[q+"props"]="data-dojo-props",D[q+"type"]=
"data-dojo-type",D[q+"mixins"]="data-dojo-mixins",D[x+"type"]="dojoType",D[q+"id"]="data-dojo-id");for(var w=0,u,x=[],A,B;u=l[w++];){var G=u.name,J=G.toLowerCase();u=u.value;switch(D[J]||J){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":B=u;break;case "data-dojo-id":case "jsid":A=u;break;case "data-dojo-attach-point":case "dojoattachpoint":p.dojoAttachPoint=u;break;case "data-dojo-attach-event":case "dojoattachevent":p.dojoAttachEvent=u;break;case "class":p["class"]=
d.className;break;case "style":p.style=d.style&&d.style.cssText;break;default:if(G in m||(G=F(a)[J]||G),G in m)switch(typeof m[G]){case "string":p[G]=u;break;case "number":p[G]=u.length?Number(u):NaN;break;case "boolean":p[G]="false"!=u.toLowerCase();break;case "function":""===u||-1!=u.search(/[^\w\.]+/i)?p[G]=new Function(u):p[G]=f.getObject(u,!1)||new Function(u);x.push(G);break;default:J=m[G],p[G]=J&&"length"in J?u?u.split(/\s*,\s*/):[]:J instanceof Date?""==u?new Date(""):"now"==u?new Date:t.fromISOString(u):
J instanceof c?k.baseUrl+u:y(u)}else p[G]=u}}for(l=0;l<x.length;l++)D=x[l].toLowerCase(),d.removeAttribute(D),d[D]=null;if(B)try{B=y.call(h.propsThis,"{"+B+"}"),f.mixin(p,B)}catch(O){throw Error(O.toString()+" in data-dojo-props\x3d'"+B+"'");}f.mixin(p,b);g||(g=a&&(a._noScript||m._noScript)?[]:v("\x3e script[type^\x3d'dojo/']",d));var H=[],N=[],M=[],L=[];if(g)for(w=0;w<g.length;w++)D=g[w],d.removeChild(D),b=D.getAttribute(q+"event")||D.getAttribute("event"),h=D.getAttribute(q+"prop"),B=D.getAttribute(q+
"method"),x=D.getAttribute(q+"advice"),l=D.getAttribute("type"),D=this._functionFromScript(D,q),b?"dojo/connect"==l?H.push({method:b,func:D}):"dojo/on"==l?L.push({event:b,func:D}):p[b]=D:"dojo/aspect"==l?H.push({method:B,advice:x,func:D}):"dojo/watch"==l?M.push({prop:h,func:D}):N.push(D);a=(g=a.markupFactory||m.markupFactory)?g(p,d,a):new a(p,d);return a.then?a.then(e):e(a)},scan:function(a,d){function b(a){if(!a.inherited){a.inherited={};var d=a.node,h=b(a.parent),d={dir:d.getAttribute("dir")||h.dir,
lang:d.getAttribute("lang")||h.lang,textDir:d.getAttribute(s)||h.textDir},g;for(g in d)d[g]&&(a.inherited[g]=d[g])}return a.inherited}var h=[],g=[],c={},e=(d.scope||k._scopeName)+"Type",m="data-"+(d.scope||k._scopeName)+"-",p=m+"type",s=m+"textdir",m=m+"mixins",f=a.firstChild,t=d.inherited;if(!t){var x=function(a,d){return a.getAttribute&&a.getAttribute(d)||a.parentNode&&x(a.parentNode,d)},t={dir:x(a,"dir"),lang:x(a,"lang"),textDir:x(a,s)},v;for(v in t)t[v]||delete t[v]}for(var t={inherited:t},y,
z;;)if(f)if(1!=f.nodeType)f=f.nextSibling;else if(y&&"script"==f.nodeName.toLowerCase())(A=f.getAttribute("type"))&&/^dojo\/\w/i.test(A)&&y.push(f),f=f.nextSibling;else if(z)f=f.nextSibling;else{var A=f.getAttribute(p)||f.getAttribute(e);v=f.firstChild;if(!A&&(!v||3==v.nodeType&&!v.nextSibling))f=f.nextSibling;else{z=null;if(A){var B=f.getAttribute(m);y=B?[A].concat(B.split(/\s*,\s*/)):[A];try{z=u(y,d.contextRequire)}catch(F){}z||n.forEach(y,function(a){~a.indexOf("/")&&!c[a]&&(c[a]=!0,g[g.length]=
a)});B=z&&!z.prototype._noScript?[]:null;t={types:y,ctor:z,parent:t,node:f,scripts:B};t.inherited=b(t);h.push(t)}else t={node:f,scripts:y,parent:t};y=B;z=f.stopParser||z&&z.prototype.stopParser&&!d.template;f=v}}else{if(!t||!t.node)break;f=t.node.nextSibling;z=!1;t=t.parent;y=t.scripts}var H=new w;g.length?(E("dojo-debug-messages")&&console.warn("WARNING: Modules being Auto-Required: "+g.join(", ")),(d.contextRequire||l)(g,function(){H.resolve(n.filter(h,function(a){if(!a.ctor)try{a.ctor=u(a.types,
d.contextRequire)}catch(h){}for(var g=a.parent;g&&!g.types;)g=g.parent;var b=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(b&&b.stopParser&&!d.template);a.instantiate=!g||g.instantiate&&g.instantiateChildren;return a.instantiate}))})):H.resolve(h);return H.promise},_require:function(a,d){var b=y("{"+a.innerHTML+"}"),h=[],g=[],c=new w,e=d&&d.contextRequire||l,m;for(m in b)h.push(m),g.push(b[m]);e(g,function(){for(var a=0;a<h.length;a++)f.setObject(h[a],arguments[a]);c.resolve(arguments)});return c.promise},
_scanAmd:function(a,d){var b=new w,h=b.promise;b.resolve(!0);var g=this;v("script[type\x3d'dojo/require']",a).forEach(function(a){h=h.then(function(){return g._require(a,d)});a.parentNode.removeChild(a)});return h},parse:function(b,d){var c;!d&&b&&b.rootNode?(d=b,c=d.rootNode):b&&f.isObject(b)&&!("nodeType"in b)?d=b:c=b;c=c?a.byId(c):m.body();d=d||{};var h=d.template?{template:!0}:{},g=[],q=this,e=this._scanAmd(c,d).then(function(){return q.scan(c,d)}).then(function(a){return q._instantiate(a,h,d,
!0)}).then(function(a){return g=g.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});f.mixin(g,e);return g}};k.parser=p;e.parseOnLoad&&x(100,p,"parse");return p})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(l,k,f){return f("dijit.Destroyable",null,{destroy:function(f){this._destroyed=!0},own:function(){var f=["destroyRecursive","destroy","remove"];l.forEach(arguments,function(e){function a(){c.remove();
l.forEach(s,function(a){a.remove()})}var m,c=k.before(this,"destroy",function(a){e[m](a)}),s=[];e.then?(m="cancel",e.then(a,a)):l.forEach(f,function(b){"function"===typeof e[b]&&(m||(m=b),s.push(k.after(e,b,a,!0)))})},this);return arguments}})})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(l,k,f,n,e){return f("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,widgetsInTemplate:!0,contextRequire:null,
_beforeFillContent:function(){if(this.widgetsInTemplate){var a=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);e.parse(a,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(n.hitch(this,function(a){this._startupWidgets=a;for(var c=0;c<a.length;c++)this._processTemplateNode(a[c],function(a,b){return a[b]},function(a,b,c){return b in
a?a.connect(a,b,c):a.on(b,c,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(a,e,c){return e(a,"dojoType")||e(a,"data-dojo-type")?!0:this.inherited(arguments)},startup:function(){l.forEach(this._startupWidgets,
function(a){a&&(!a._started&&a.startup)&&a.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(l,k,f,n,e,a,m,c){var s=k("dijit._TemplatedMixin",c,{templateString:null,templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(a){var c=this.declaredClass,e=this;return m.substitute(a,this,
function(a,b){"!"==b.charAt(0)&&(a=n.getObject(b.substr(1),!1,e));if("undefined"==typeof a)throw Error(c+" template:"+b);return null==a?"":"!"==b.charAt(0)?a:this._escapeValue(""+a)},this)},_escapeValue:function(a){return a.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||(this.templateString=l(this.templatePath,{sanitize:!0}));var a=s.getCachedTemplate(this.templateString,
this._skipNodeCache,this.ownerDocument),c;if(n.isString(a)){if(c=f.toDom(this._stringRepl(a),this.ownerDocument),1!=c.nodeType)throw Error("Invalid template: "+a);}else c=a.cloneNode(!0);this.domNode=c}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(a){var c=this.containerNode;if(a&&c)for(;a.hasChildNodes();)c.appendChild(a.firstChild)}});s._templateCache={};s.getCachedTemplate=function(a,c,e){var l=s._templateCache,k=a,n=l[k];
if(n){try{if(!n.ownerDocument||n.ownerDocument==(e||document))return n}catch(x){}f.destroy(n)}a=m.trim(a);if(c||a.match(/\$\{([^\}]+)\}/g))return l[k]=a;c=f.toDom(a,e);if(1!=c.nodeType)throw Error("Invalid template: "+a);return l[k]=c};a("ie")&&e(window,"unload",function(){var a=s._templateCache,c;for(c in a){var e=a[c];"object"==typeof e&&f.destroy(e);delete a[c]}});return s})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(l,
k,f,n,e){l=l(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(a){k.mixin(this,a);e.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});f("extend-esri")&&k.setObject("layers.KMLFolder",l,n);return l})},"dojo/cache":function(){define(["./_base/kernel","./text"],function(l){return l.cache})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(l,k,f,n){f(function(){k("highcontrast")&&l.add(n.body(),"dijit_a11y")});return k})},
"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(l,k,f,n,e,a,m,c){l=l([a,m],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(a,b){k.mixin(this,b);this.initialize(a,b)},getTitle:function(a){var b;this.info&&(b=this.titleHasRelatedFields?"":this._getPopupValues(a,!0).title);return b||""},getContent:function(a){return this.info?
(new c({template:this,graphic:a,chartTheme:this.chartTheme},n.create("div"))).domNode:""}});f("extend-esri")&&k.setObject("dijit.PopupTemplate",l,e);return l})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),function(l,k,f,n,e,a,m){e.add("highcontrast",function(){var a=m.doc.createElement("div");a.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+
(k.blankGif||l.toUrl("./resources/blank.gif"))+'");';m.body().appendChild(a);var f=n.getComputedStyle(a),b=f.backgroundImage,f=f.borderTopColor==f.borderRightColor||b&&("none"==b||"url(invalid-url:)"==b);8>=e("ie")?a.outerHTML="":m.body().removeChild(a);return f});a(function(){e("highcontrast")&&f.add(m.body(),"dj_a11y")});return e})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),
function(l,k,f,n,e,a,m){a.extend(l,{waiRole:"",waiState:""});return e("dijit._Templated",[k,f],{widgetsInTemplate:!1,constructor:function(){m.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0")},_processNode:function(a,e){var b=this.inherited(arguments),f=e(a,"waiRole");f&&a.setAttribute("role",f);(f=e(a,"waiState"))&&n.forEach(f.split(/\s*,\s*/),function(b){-1!=b.indexOf("-")&&(b=b.split("-"),a.setAttribute("aria-"+
b[0],b[1]))});return b}})})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(l,k,f,n){n.extend(k,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return f("dijit._FocusMixin",null,{_focusManager:l})})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),
function(l,k,f,n,e,a,m,c,s,b,t,w,E){function v(){}function z(a){return function(b,c,e,l){return b&&"string"==typeof c&&b[c]==v?b.on(c.substring(2).toLowerCase(),m.hitch(e,l)):a.apply(f,arguments)}}l.around(f,"connect",z);a.connect&&l.around(a,"connect",z);l=n("dijit._Widget",[t,w,E],{onClick:v,onDblClick:v,onKeyDown:v,onKeyPress:v,onKeyUp:v,onMouseDown:v,onMouseMove:v,onMouseOut:v,onMouseOver:v,onMouseLeave:v,onMouseEnter:v,onMouseUp:v,constructor:function(a){this._toConnect={};for(var b in a)this[b]===
v&&(this._toConnect[b.replace(/^on/,"").toLowerCase()]=a[b],delete a[b])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,this._toConnect[a]);delete this._toConnect},on:function(a,b){return this[this._onMap(a)]===v?f.connect(this.domNode,a.toLowerCase(),this,b):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(b,c){a.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.",
"","2.0");this.set(b,c)},attr:function(a,b){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){a.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?c("[widgetId]",this.containerNode).map(b.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});e("dijit-legacy-requires")&&s(0,function(){require(["dijit/_base"])});
return l})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),function(l,k,f,n,e,a,m,c,s,b,t,w,E,v,z,x,y,F,u,A){var B=0;k=k([u,z,x],{declaredClass:"esri.dijit._PopupRenderer",
constructor:function(){this._nls=n.mixin({},A.widgets.popup)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this.template.getComponents(this.graphic).then(n.hitch(this,this._handleComponentsSuccess),n.hitch(this,this._handleComponentsError))},destroy:function(){this._dfd&&this._dfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments)},_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+
1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var c=this._mediaInfos,f=c.length,d=this.domNode,r=this._prevMedia,h=this._nextMedia;if(1<f){var g=0,q=0;e.forEach(c,function(a){"image"===a.type?g++:-1!==a.type.indexOf("chart")&&q++});g&&(b.set(this._imageCount,"innerHTML",g),a.query(".summary .image",d).removeClass("hidden"));q&&(b.set(this._chartCount,"innerHTML",q),a.query(".summary .chart",d).removeClass("hidden"))}else a.query(".summary",
d).addClass("hidden"),t.add(r,"hidden"),t.add(h,"hidden");c=this._mediaPtr;0===c?t.add(r,"hidden"):t.remove(r,"hidden");c===f-1?t.add(h,"hidden"):t.remove(h,"hidden");this._destroyFrame()},_displayMedia:function(){var c=this._mediaInfos[this._mediaPtr],e=c.title,d=c.caption,r=a.query(".mediaSection .hzLine",this.domNode)[0];b.set(this._mediaTitle,"innerHTML",e);t[e?"remove":"add"](this._mediaTitle,"hidden");b.set(this._mediaCaption,"innerHTML",d);t[d?"remove":"add"](this._mediaCaption,"hidden");t[e&&
d?"remove":"add"](r,"hidden");this._rid=null;if("image"===c.type)this._showImage(c.value);else{var h=this,e=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],d=c.value.theme||this.chartTheme;n.isString(d)&&(d=d.replace(/\./gi,"/"),-1===d.indexOf("/")&&(d="dojox/charting/themes/"+d));d||(d="./Rainbow");e.push(d);try{var g=this._rid=B++;l(e,function(a,d,b){g===h._rid&&(h._rid=null,h._showChart(c.type,c.value,a,d,b))})}catch(q){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(a){return(a=
a&&n.trim(a).toLowerCase())&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(b){t.add(this._mediaFrame,"image");var c=E.get(this._gallery,"height"),d;b.linkURL&&(d=w.create("a",{href:b.linkURL,target:this._preventNewTab(b.linkURL)?"":"_blank"},this._mediaFrame));w.create("img",{className:"esriPopupMediaImage",src:b.sourceURL},d||this._mediaFrame);var e=a.query(".esriPopupMediaImage",this._mediaFrame)[0],h=this,g;g=f.connect(e,"onload",function(){f.disconnect(g);g=null;h._imageLoaded(e,
c)})},_showChart:function(a,b,d,c,h){t.remove(this._mediaFrame,"image");d=this._chart=new d(w.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});h&&d.setTheme(h);switch(a){case "piechart":d.addPlot("default",{type:"Pie",labels:!1});d.addSeries("Series A",b.fields);break;case "linechart":d.addPlot("default",{type:"Markers"});d.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});d.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});e.forEach(b.fields,
function(a,d){a.x=d+1});d.addSeries("Series A",b.fields);break;case "columnchart":d.addPlot("default",{type:"Columns",gap:3});d.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});d.addSeries("Series A",b.fields);break;case "barchart":d.addPlot("default",{type:"Bars",gap:3}),d.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),d.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),d.addSeries("Series A",b.fields)}this._action=new c(d);d.render()},
_destroyFrame:function(){this._rid=null;this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);b.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,b){var d=a.height;d<b&&(d=Math.round((b-d)/2),E.set(a,"marginTop",d+"px"))},_attListHandler:function(a,c){if(a===this._dfd){this._dfd=null;var d="";!(c instanceof Error)&&(c&&c.length)&&e.forEach(c,function(a){d+="\x3cli\x3e";d+="\x3ca href\x3d'"+F.addProxy(a.url)+"' target\x3d'_blank'\x3e"+
(a.name||"[No name]")+"\x3c/a\x3e";d+="\x3c/li\x3e"});b.set(this._attachmentsList,"innerHTML",d||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_handleComponentsSuccess:function(c){if(c){var f=this.showTitle?c.title:"",d=c.description,r=c.fields,h=c.mediaInfos,g=this.domNode,q=this._nls,m=this,l=this.template,k=this.graphic;this._prevMedia.title=q.NLS_prevMedia;this._nextMedia.title=q.NLS_nextMedia;b.set(this._title,"innerHTML",f);f||t.add(this._title,"hidden");!c.hasDescription&&r&&(d="",e.forEach(r,
function(a){d+="\x3ctr valign\x3d'top'\x3e";d+="\x3ctd class\x3d'attrName'\x3e"+v.encode(a[0])+"\x3c/td\x3e";d+="\x3ctd class\x3d'attrValue'\x3e"+a[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+q.NLS_moreInfo+"\x3c/a\x3e")+"\x3c/td\x3e";d+="\x3c/tr\x3e"}),d&&(d="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+d+"\x3c/table\x3e"));b.set(this._description,"innerHTML",d);d||t.add(this._description,"hidden");a.query("a",
this._description).forEach(function(a){m._preventNewTab(a.href)?"_blank"===a.target&&b.remove(a,"target"):b.set(a,"target","_blank")});f&&d?a.query(".mainSection .hzLine",g).removeClass("hidden"):f||d?a.query(".mainSection .hzLine",g).addClass("hidden"):a.query(".mainSection",g).addClass("hidden");if(f=this._dfd=l.getAttachments(k))f.addBoth(n.hitch(this,this._attListHandler,f)),b.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+q.NLS_searching+"...\x3c/li\x3e"),a.query(".attachmentsSection",g).removeClass("hidden");
h&&h.length&&(a.query(".mediaSection",g).removeClass("hidden"),s.setSelectable(this._mediaFrame,!1),this._mediaInfos=h,this._mediaPtr=0,this._updateUI(),this._displayMedia());c.editSummary&&(b.set(this._editSummary,"innerHTML",c.editSummary),h&&h.length&&t.remove(this._mediaBreak,"hidden"),t.remove(this._editSummarySection,"hidden"))}},_handleComponentsError:function(a){console.log("PopupRenderer: error loading template",a)}});m("extend-esri")&&n.setObject("dijit._PopupRenderer",k,y);return k})},
"dojox/html/entities":function(){define(["dojo/_base/lang"],function(l){var k=l.getObject("dojox.html.entities",!0),f=function(e,a){var f,c;if(a._encCache&&a._encCache.regexp&&a._encCache.mapper&&a.length==a._encCache.length)f=a._encCache.mapper,c=a._encCache.regexp;else{f={};c=["["];var l;for(l=0;l<a.length;l++)f[a[l][0]]="\x26"+a[l][1]+";",c.push(a[l][0]);c.push("]");c=RegExp(c.join(""),"g");a._encCache={mapper:f,regexp:c,length:a.length}}return e=e.replace(c,function(a){return f[a]})},n=function(e,
a){var f,c;if(a._decCache&&a._decCache.regexp&&a._decCache.mapper&&a.length==a._decCache.length)f=a._decCache.mapper,c=a._decCache.regexp;else{f={};c=["("];var l;for(l=0;l<a.length;l++){var b="\x26"+a[l][1]+";";l&&c.push("|");f[b]=a[l][0];c.push(b)}c.push(")");c=RegExp(c.join(""),"g");a._decCache={mapper:f,regexp:c,length:a.length}}return e=e.replace(c,function(a){return f[a]})};k.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];k.latin=[["\u00a1","iexcl"],["\u00a2",
"cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],
["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],
["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1",
"ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],
["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],
["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],
["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],
["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665",
"hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039",
"lsaquo"],["\u203a","rsaquo"]];k.encode=function(e,a){e&&(a?e=f(e,a):(e=f(e,k.html),e=f(e,k.latin)));return e};k.decode=function(e,a){e&&(a?e=n(e,a):(e=n(e,k.html),e=n(e,k.latin)));return e};return k})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(l,k,f,n,e,a,m,c,s,b,t,w,E,v,z,x,y,F,u,A,B,p,C){function d(a){return function(d){c[d?"set":"remove"](this.domNode,a,d);this._set(a,d)}}E.add("dijit-legacy-requires",!v.isAsync);E.add("dojo-bidi",!1);E("dijit-legacy-requires")&&y(0,function(){l(["dijit/_base/manager"])});var r={};n=a("dijit._WidgetBase",[F,B],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:d("lang"),dir:"",_setDirAttr:d("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:n.blankGif||l.toUrl("dojo/resources/blank.gif"),_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var d=a.prototype,b=a._setterAttrs=[],a=a._onMap={},c;for(c in d.attributeMap)b.push(c);for(c in d)/^on/.test(c)&&(a[c.substring(2).toLowerCase()]=c),/^_set[A-Z](.*)Attr$/.test(c)&&(c=c.charAt(4).toLowerCase()+c.substr(5,
c.length-9),(!d.attributeMap||!(c in d.attributeMap))&&b.push(c))}},postscript:function(a,d){this.create(a,d)},create:function(a,d){this._introspect();this.srcNodeRef=m.byId(d);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,z.mixin(this,a));this.postMixInProperties();this.id||(this.id=C.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=this.ownerDocument||
(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=A.body(this.ownerDocument);C.add(this);this.buildRendering();var b;if(this.domNode){this._applyAttributes();var c=this.srcNodeRef;c&&(c.parentNode&&this.domNode!==c)&&(c.parentNode.replaceChild(this.domNode,c),b=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();b&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},d;for(d in this.params||{})a[d]=this._get(d);k.forEach(this.constructor._setterAttrs,
function(d){if(!(d in a)){var b=this._get(d);b&&this.set(d,b)}},this);for(d in a)this.set(d,a[d])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(k.map(a,function(a){return a+"Rtl"})));s.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=!0,k.forEach(this.getChildren(),function(a){!a._started&&
(!a._destroyed&&z.isFunction(a.startup))&&(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function d(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.uninitialize();k.forEach(this._connects,z.hitch(this,"disconnect"));k.forEach(this._supportingWidgets,d);this.domNode&&k.forEach(C.findWidgets(this.domNode,this.containerNode),d);this.destroyRendering(a);
C.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?c.remove(this.domNode,"widgetId"):b.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||b.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){k.forEach(this.getChildren(),function(d){d.destroyRecursive&&d.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(a){var d=this.domNode;z.isObject(a)?
w.set(d,a):d.style.cssText=d.style.cssText?d.style.cssText+("; "+a):a;this._set("style",a)},_attrToDom:function(a,d,b){b=3<=arguments.length?b:this.attributeMap[a];k.forEach(z.isArray(b)?b:[b],function(b){var e=this[b.node||b||"domNode"];switch(b.type||"attribute"){case "attribute":z.isFunction(d)&&(d=z.hitch(this,d));b=b.attribute?b.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;e.tagName?c.set(e,b,d):e.set(b,d);break;case "innerText":e.innerHTML="";e.appendChild(this.ownerDocument.createTextNode(d));
break;case "innerHTML":e.innerHTML=d;break;case "class":s.replace(e,d,this[a])}},this)},get:function(a){var d=this._getAttrNames(a);return this[d.g]?this[d.g]():this._get(a)},set:function(a,d){if("object"===typeof a){for(var b in a)this.set(b,a[b]);return this}b=this._getAttrNames(a);var c=this[b.s];if(z.isFunction(c))var e=c.apply(this,Array.prototype.slice.call(arguments,1));else{var c=this.focusNode&&!z.isFunction(this.focusNode)?"focusNode":"domNode",f=this[c]&&this[c].tagName,l;if(l=f)if(!(l=
r[f])){l=this[c];var m={},k;for(k in l)m[k.toLowerCase()]=!0;l=r[f]=m}k=l;b=a in this.attributeMap?this.attributeMap[a]:b.s in this?this[b.s]:k&&b.l in k&&"function"!=typeof d||/^aria-|^data-|^role$/.test(a)?c:null;null!=b&&this._attrToDom(a,d,b);this._set(a,d)}return e||this},_attrPairNames:{},_getAttrNames:function(a){var d=this._attrPairNames;if(d[a])return d[a];var b=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});return d[a]={n:a+"Node",s:"_set"+b+"Attr",
g:"_get"+b+"Attr",l:b.toLowerCase()}},_set:function(a,d){var b=this[a];this[a]=d;if(this._created&&!(b===d||b!==b&&d!==d))this._watchCallbacks&&this._watchCallbacks(a,b,d),this.emit("attrmodified-"+a,{detail:{prevValue:b,newValue:d}})},_get:function(a){return this[a]},emit:function(a,d,b){d=d||{};void 0===d.bubbles&&(d.bubbles=!0);void 0===d.cancelable&&(d.cancelable=!0);d.detail||(d.detail={});d.detail.widget=this;var c,e=this["on"+a];e&&(c=e.apply(this,b?b:[d]));this._started&&!this._beingDestroyed&&
x.emit(this.domNode,a.toLowerCase(),d);return c},on:function(a,d){var b=this._onMap(a);return b?f.after(this,b,d,!0):this.own(x(this.domNode,a,d))[0]},_onMap:function(a){var d=this.constructor,b=d._onMap;if(!b){var b=d._onMap={},c;for(c in d.prototype)/^on/.test(c)&&(b[c.replace(/^on/,"").toLowerCase()]=c)}return b["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?C.findWidgets(this.containerNode):
[]},getParent:function(){return C.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,d,b){return this.own(e.connect(a,d,this,b))[0]},disconnect:function(a){a.remove()},subscribe:function(a,d){return this.own(u.subscribe(a,z.hitch(this,d)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():t.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=w.get(this.domNode,"display")},placeAt:function(a,d){var c=
!a.tagName&&C.byId(a);c&&c.addChild&&(!d||"number"===typeof d)?c.addChild(this,d):(c=c&&"domNode"in c?c.containerNode&&!/after|before|replace/.test(d||"")?c.containerNode:c.domNode:m.byId(a,this.ownerDocument),b.place(this.domNode,c,d),!this._started&&(this.getParent()||{})._started&&this.startup());return this},defer:function(a,d){var b=setTimeout(z.hitch(this,function(){b&&(b=null,this._destroyed||z.hitch(this,a)())}),d||0);return{remove:function(){b&&(clearTimeout(b),b=null);return null}}}});E("dojo-bidi")&&
n.extend(p);return n})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(l,k){var f={};l.setObject("dojo.date.stamp",f);f.fromISOString=function(l,e){f._isoRegExp||(f._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var a=f._isoRegExp.exec(l),m=null;if(a){a.shift();a[1]&&a[1]--;a[6]&&(a[6]*=1E3);e&&(e=new Date(e),k.forEach(k.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),
function(a){return e["get"+a]()}),function(b,c){a[c]=a[c]||b}));m=new Date(a[0]||1970,a[1]||0,a[2]||1,a[3]||0,a[4]||0,a[5]||0,a[6]||0);100>a[0]&&m.setFullYear(a[0]||1970);var c=0,s=a[7]&&a[7].charAt(0);"Z"!=s&&(c=60*(a[8]||0)+(Number(a[9])||0),"-"!=s&&(c*=-1));s&&(c-=m.getTimezoneOffset());c&&m.setTime(m.getTime()+6E4*c)}return m};f.toISOString=function(f,e){var a=function(a){return 10>a?"0"+a:a};e=e||{};var l=[],c=e.zulu?"getUTC":"get",k="";"time"!=e.selector&&(k=f[c+"FullYear"](),k=["0000".substr((k+
"").length)+k,a(f[c+"Month"]()+1),a(f[c+"Date"]())].join("-"));l.push(k);if("date"!=e.selector){k=[a(f[c+"Hours"]()),a(f[c+"Minutes"]()),a(f[c+"Seconds"]())].join(":");c=f[c+"Milliseconds"]();e.milliseconds&&(k+="."+(100>c?"0":"")+a(c));if(e.zulu)k+="Z";else if("time"!=e.selector)var c=f.getTimezoneOffset(),b=Math.abs(c),k=k+((0<c?"-":"+")+a(Math.floor(b/60))+":"+a(b%60));l.push(k)}return l.join("T")};return f})},"*noref":1}});
define("esri/layers/KMLLayer","dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),function(l,k,f,n,e,a,m,c,s,b,t,w,E,v,z,x,y,F,u,A,B,p){var C=k([F],{declaredClass:"esri.layers.KMLLayer",serviceUrl:location.protocol+
"//utility.arcgis.com/sharing/kml",constructor:function(a,b){a||console.log("KMLLayer:constructor - please provide url for the KML file");this._outSR=b&&b.outSR||new z({wkid:4326});this._options=n.mixin({},b);w.defaults.kmlService&&(this.serviceUrl=w.defaults.kmlService);var c=this.linkInfo=b&&b.linkInfo;c&&(this.visible=!!c.visibility,this._waitingForMap=!!c.viewFormat);(!c||c&&c.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=n.hitch(this,this.refresh);this.registerConnectEvents("esri.layers.KMLLayer",
!0)},getFeature:function(a){if(a){var b=a.type,c=a.id,g;switch(b){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(a=this["_"+b])&&(g=n.getObject("_mode._featureMap."+c,!1,a));break;case "GroundOverlay":if(a=this._groundLyr){var f=a.getImages(),b=f.length;for(a=0;a<b;a++)if(f[a].id===c){g=f[a];break}}break;case "ScreenOverlay":break;case "NetworkLink":e.some(this._links,function(a){return a.linkInfo&&a.linkInfo.id===c?(g=a,!0):!1});break;case "Folder":b=(f=this.folders)?
f.length:0;for(a=0;a<b;a++)if(f[a].id===c){g=f[a];break}break;default:console.log("KMLLayer:getFeature - unknown feature type")}return g}},getLayers:function(){var a=[];this._groundLyr&&a.push(this._groundLyr);this._fLayers&&(a=a.concat(this._fLayers));this._links&&e.forEach(this._links,function(b){b.declaredClass&&a.push(b)});return a},setFolderVisibility:function(a,b){a&&(this._fireUpdateStart(),(a.visible=b)&&(b=this._areLocalAncestorsVisible(a)),this._setState(a,b),this._fireUpdateEnd())},onRefresh:function(){},
onOpacityChange:function(){},_parseKml:function(d){var b=this;this._fireUpdateStart();this._io=v({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(d),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:a.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(a){b._io=null;b._initLayer(a)},error:function(a){b._io=null;a=n.mixin(Error(),a);a.message="Unable to load KML: "+b.url+" "+(a.message||"");b._fireUpdateEnd(a);b.onError(a)}})},_initLayer:function(a){var b;
this.loaded&&(b=[],e.forEach(this.folders,function(a){a.visible&&b.push(a.id)}),this._options.minScale=this.minScale,this._options.maxScale=this.maxScale,this._options.opacity=this.opacity,this._removeInternalLayers());this.name=a.name;this.description=a.description;this.snippet=a.snippet;this.visibility=a.visibility;this.featureInfos=a.featureInfos;var c,g,f=this.folders=a.folders,l=[],k;if(f){g=f.length;for(c=0;c<g;c++)k=f[c]=new u(f[c]),-1===k.parentFolderId&&l.push(k)}var f=this._links=a.networkLinks,
m;g=f?f.length:0;for(c=0;c<g;c++)f[c].viewRefreshMode&&-1!==f[c].viewRefreshMode.toLowerCase().indexOf("onregion")||(m=n.mixin({},this._options),m.linkInfo=f[c],m.id&&(m.id=m.id+"_"+c),f[c]=new C(f[c].href,m),f[c]._parentLayer=this,f[c]._parentFolderId=this._getLinkParentId(f[c].linkInfo.id));if((f=a.groundOverlays)&&0<f.length){m=n.mixin({},this._options);m.id&&(m.id+="_mapImage");k=this._groundLyr=new B(m);g=f.length;for(c=0;c<g;c++)k.addImage(new A(f[c]))}if((a=n.getObject("featureCollection.layers",
!1,a))&&0<a.length)this._fLayers=[],e.forEach(a,function(a,d){var b=n.getObject("featureSet.features",!1,a);b&&0<b.length&&(m=n.mixin({outFields:["*"],infoTemplate:a.popupInfo?new y(a.popupInfo):null,editable:!1},this._options),m.id&&(m.id=m.id+"_"+d),a.layerDefinition.capabilities="Query,Data",b=new p(a,m),b.geometryType&&(this["_"+b.geometryType]=b),this._fLayers.push(b))},this),0===this._fLayers.length&&delete this._fLayers;if(!this.loaded){g=l.length;for(c=0;c<g;c++)k=l[c],this._setState(k,k.visible)}this._fireUpdateEnd();
this.loaded?(this._addInternalLayers(),e.forEach(this.folders,function(a){-1<e.indexOf(b,a.id)?this.setFolderVisibility(a,!0):this.setFolderVisibility(a,!1)},this),this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var a=this._map;this._fireUpdateStart();this._links&&e.forEach(this._links,function(b){b.declaredClass&&(a.addLayer(b),b._waitingForMap&&(b._waitingForMap=null,b.visible?b._parseKml(a):b._wMap=a))});var b=a.spatialReference,c=this._outSR,g;if(!b.equals(c))if(b.isWebMercator()&&
4326===c.wkid)g=x.geographicToWebMercator;else if(c.isWebMercator()&&4326===b.wkid)g=x.webMercatorToGeographic;else{console.log("KMLLayer:_setMap - unsupported workflow. Spatial reference of the map and kml layer do not match, and the conversion cannot be done on the client.");return}this._groundLyr&&(g&&e.forEach(this._groundLyr.getImages(),function(a){a.extent=g(a.extent)}),a.addLayer(this._groundLyr));(b=this._fLayers)&&0<b.length&&e.forEach(b,function(b){if(g){var c=b.graphics,e,h,f=c?c.length:
0;for(e=0;e<f;e++)(h=c[e].geometry)&&c[e].setGeometry(g(h))}a.addLayer(b)});this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var a=this._map;this._links&&e.forEach(this._links,function(a){a.declaredClass&&a._io&&a._io.cancel()});a&&e.forEach(this.getLayers(),a.removeLayer,a)},_setState:function(a,b){var c=a.featureInfos,e,f,l,m=c?c.length:0,k=b?"show":"hide";for(l=0;l<m;l++)if(e=c[l],f=this.getFeature(e))if("Folder"===e.type)this._setState(f,b&&f.visible);else if("NetworkLink"===
e.type)this._setInternalVisibility(f,b);else f[k]()},_areLocalAncestorsVisible:function(a){var b=a.parentFolderId;for(a=a.visible;a&&-1!==b;)b=this.getFeature({type:"Folder",id:b}),a=a&&b.visible,b=b.parentFolderId;return a},_setInternalVisibility:function(a,b){var c=a._parentLayer,e=a._parentFolderId;for(b=b&&a.visible;b&&c;)b=b&&c.visible,-1<e&&(b=b&&c._areLocalAncestorsVisible(c.getFeature({type:"Folder",id:e}))),e=c._parentFolderId,c=c._parentLayer;this._setIntState(a,b)},_setIntState:function(a,
b){a&&e.forEach(a.getLayers(),function(c){c.linkInfo?a._setIntState(c,b&&c.visible&&a._areLocalAncestorsVisible(a.getFeature({type:"Folder",id:c._parentFolderId}))):c.setVisibility(b)})},_getLinkParentId:function(a){var b=-1;this.folders&&e.some(this.folders,function(c){return c.networkLinkIds&&-1!==e.indexOf(c.networkLinkIds,a)?(b=c.id,!0):!1});return b},_checkAutoRefresh:function(){var a=this.linkInfo;if(a)if(this.visible){if(this.loaded&&this._map){var b=a.refreshMode,c=a.refreshInterval,e=a.viewRefreshMode,
a=a.viewRefreshTime;b&&(-1!==b.toLowerCase().indexOf("oninterval")&&0<c)&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*c));e&&(-1!==e.toLowerCase().indexOf("onstop")&&0<a)&&!this._extChgHandle&&(this._extChgHandle=f.connect(this._map,"onExtentChange",this,this._extentChanged))}}else this._stopAutoRefresh(),f.disconnect(this._extChgHandle),delete this._extChgHandle},_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null},_getQueryParameters:function(a){a=
a||this._map;var b={},e=this.linkInfo,g=a&&a.extent,f;this._url.query&&(n.mixin(b,this._url.query),f=!!this._url.query.token);if(t.id&&!f&&(f=t.id.findCredential(this._url.path)))b.token=f.token;if(e){f=e.viewFormat;var m=e.httpQuery,e=e.viewBoundScale;if(g&&f){var k=g,p=g,s=g.spatialReference;s&&(s.isWebMercator()?k=x.webMercatorToGeographic(g):4326===s.wkid&&(p=x.geographicToWebMercator(g)));g=k.getCenter();p=Math.max(p.getWidth(),p.getHeight());e&&(k=k.expand(e));f=f.replace(/\[bboxWest\]/ig,k.xmin).replace(/\[bboxEast\]/ig,
k.xmax).replace(/\[bboxSouth\]/ig,k.ymin).replace(/\[bboxNorth\]/ig,k.ymax).replace(/\[lookatLon\]/ig,g.x).replace(/\[lookatLat\]/ig,g.y).replace(/\[lookatRange\]/ig,p).replace(/\[lookatTilt\]/ig,0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,g.x).replace(/\[lookatTerrainLat\]/ig,g.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,g.x).replace(/\[cameraLat\]/ig,g.y).replace(/\[cameraAlt\]/ig,p).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,
a.width).replace(/\[vertPixels\]/ig,a.height).replace(/\[terrainEnabled\]/ig,0);n.mixin(b,c.queryToObject(f))}m&&(m=m.replace(/\[clientVersion\]/ig,t.version).replace(/\[kmlVersion\]/ig,2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,l.locale),n.mixin(b,c.queryToObject(m)))}a=[];for(var u in b)E.isDefined(b[u])&&a.push(u+"\x3d"+b[u]);return(a=a.join("\x26"))?"?"+a:""},setScaleRange:function(a,b){this.inherited(arguments);e.forEach(this.getLayers(),function(c){c.setScaleRange(a,
b)})},setOpacity:function(a){this.opacity!=a&&(e.forEach(this.getLayers(),function(b){b.setOpacity(a)}),this.opacity=a,this.onOpacityChange(a))},_setMap:function(a,c){this.inherited(arguments);this._map=a;var e=this._div=s.create("div",null,c);b.set(e,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return e},_unsetMap:function(a,b){this._io&&this._io.cancel();this._stopAutoRefresh();f.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();
var c=this._div;c&&(b.removeChild(c),s.destroy(c));this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(a){this.loaded?(this._fireUpdateStart(),this._setInternalVisibility(this,a),this._checkAutoRefresh(),this._fireUpdateEnd()):this.linkInfo&&a&&(this._waitingForMap||this._parseKml(this._wMap))},refresh:function(){this.loaded&&(this._map&&!this._io&&this.visible)&&this._parseKml()},getFeatureCollection:function(a){var b,c=[];if(a=this.getFeature({type:"Folder",id:a}))(b=
e.map(a.featureInfos,function(a){if("esriGeometryPoint"===a.type||"esriGeometryPolyline"===a.type||"esriGeometryPolygon"===a.type)return a.id},this))&&0<b.length&&e.forEach(this._fLayers,function(a){var d,f;d=a.toJson();d.featureSet.features&&0<d.featureSet.features.length&&(f=e.filter(d.featureSet.features,function(c){if(-1!==e.indexOf(b,c.attributes[a.objectIdField]))return c},this));f&&0<f.length&&(d.featureSet.features=f,c.push(d))},this);return c},getFeatureCount:function(a){a=this.getFeature({type:"Folder",
id:a});var b={points:0,polylines:0,polygons:0};a&&e.forEach(a.featureInfos,function(a){"esriGeometryPoint"===a.type&&(b.points+=1);"esriGeometryPolyline"===a.type&&(b.polylines+=1);"esriGeometryPolygon"===a.type&&(b.polygons+=1)});return b},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});m("extend-esri")&&n.setObject("layers.KMLLayer",C,t);return C});